


Timepoint 2  {data-icon="fa-table"}
=====================================  

Row
-----------------------------------------------------------------------
### Numbers of students who completed SELweb

```{r}
valueBox(length(district_time2$overall.cat), icon = "fa-child")
```

### Numbers of schools that administered SELweb

```{r}
#comments <- computeComments()
valueBox(length(unique(district_time2$School)), icon = "fa-building")
```


Row {data-height=500, .tabset .tabset-fade}
-----------------------------------------------------------------------

### Summary Scores by School

```{r}

make_summary_table(school_links_2, district_name)

```


### Summary Plot for District

```{r}

n_district_time2 <- dim(district_time2)[1]

make_summary_plot(data_for_plotting_2, district_name, n_district_time2)

```

```{r, echo = F, results='asis'}

if(params$student_data == TRUE) {
  cat(paste0('\n### Student-level data', '\n'))
}
```


```{r}

# student_level_2 <- district_time2[,c("StudentID", "Timepoint", "Language", "Grade", "LastName", 
#                              "School", "OverallScore", "ERScore", "SPTScore", "SPSScore", "SCScore")]
#   #1:2, 4:7, 13, 16, 18, 20, 24, 27)]
# names(student_level_2) <- c("Student ID", "Timepoint", "Language", "Grade", "Last Name", "School", "Overall Score", "Emotion Recognition", "Social Perspective-Taking", "Social Problem-Solving", "Self-Control")
# 
# make_student_level_table(student_level_2)


#prep data for student-level table (with links to individual student reports)
student_links_district_2 <- make_student_links_district_pdf(district_time2, 2)

make_student_level_table_links(student_links_district_2)

```

### PDF report
```{r}

xfun::embed_file(pdf_district_2)
```

Change Over Time {data-icon="fa-bar-chart"}
=====================================  

Row {data-height=650, .tabset .tabset-fade}
-----------------------------------------------------------------------

### District-level
```{r}

common_students <- intersect(district$StudentID, district_time2$StudentID)

#common <- district_time2[(district_time2$StudentID %in% district$StudentID),]

district_common_1 <- district[(district$StudentID %in% common_students),]
district_common_2 <- district_time2[(district_time2$StudentID %in% common_students),]

district_time1_plotting <- transform_for_plotting(district_common_1)
district_time2_plotting <- transform_for_plotting(district_common_2)


data_for_plotting_change_1 <- district_time1_plotting %>% 
  mutate(Timepoint = "Fall")

data_for_plotting_change_2 <- district_time2_plotting %>% 
  mutate(Timepoint = "Spring")

data_for_plotting_change <- rbind(data_for_plotting_change_1, data_for_plotting_change_2)


plot_change_over_time_ee(data_for_plotting_change, district_name, dim(district_common_2)[1])



```

### PDF report
```{r}
xfun::embed_file(pdf_district_change)

```

